---
layout: post
title:  "æ•°æ®ç§‘å­¦å‘çš„PYTHON ğŸ Charpter2 ä½œç”¨åŸŸçš„æ¦‚å¿µ"
categories: python
permalink: :/categories/:day/:month:/year
---

## Scope in function å‡½æ•°é‡Œä½œç”¨åŸŸçš„æ¦‚å¿µ

ä¸æ˜¯æ‰€æœ‰çš„objectéƒ½å¯ä»¥åœ¨ä»»æ„çš„åœ°æ–¹å¯ä»¥accessã€‚åœ¨pythoné‡Œæ¯ä¸€ä¸ªobjectï¼ˆå¯ä»¥æ˜¯å˜é‡ä¹Ÿå¯ä»¥æ˜¯å‡½æ•°ï¼‰éƒ½æ˜¯æœ‰ä¸€ä¸ªè·å–çš„èŒƒå›´ï¼Œè¿™ä¸ªèŒƒå›´è¢«ç§°ä¸ºä½œç”¨åŸŸã€‚

ä¸€èˆ¬æ¥è¯´ï¼Œpythonæœå¯»çš„é¡ºåºå¦‚ä¸‹ï¼š

- local scope æœ¬åœ°ä½œç”¨åŸŸ
- global scope å…¨å±€ä½œç”¨åŸŸ
- Built-in scope å†…ç½®ä½œç”¨åŸŸ

```python
new_val = 10
def square(value): 
  """Returns the square of a number."""
  new_val = value ** 2
  return new_val
print(square(3))
print(new_val)
```

```
9
10
```

åœ¨å‡½æ•°é‡Œï¼Œnew_valçš„å€¼è¢«èµ‹äºˆ9å¹¶è¢«è¿”å›ï¼Œä½†æ˜¯åœ¨å‡½æ•°å¤–ï¼Œå®ƒä¾ç„¶æ˜¯10ã€‚

### globalå…³é”®å­—

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`global`å»æ ‡æ³¨å˜é‡ï¼Œæ¥å‘Šè¯‰pythonå…ˆä»å“ªä¸ªscopeæŸ¥æ‰¾ã€‚

è¯·çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š

```python
num = 5
def func1():
    num = 3
    print(num)

def func2():
    global num
    double_num = num * 2
    num = 6
    print(double_num)
func1()
func2()
print(num)
```

```
3
10
6
```

å…¨å±€å˜é‡`num`=5ï¼Œåœ¨`func1`è¾“å‡ºå±€éƒ¨å˜é‡`num` = 3ï¼Œè€Œåœ¨`func2`ä¸­è¾“å‡ºå±€éƒ¨å˜é‡`double_num` = 5*2=10ã€‚éšåä¿®æ”¹`num`=6ï¼Œå› ä¸ºå±€éƒ¨å˜é‡è¢«`global`ä¿®é¥°å…¨å±€åŒ–ï¼Œæ‰€ä»¥èµ‹å€¼ç›´æ¥ä¿®æ”¹å…¨å±€å˜é‡ã€‚æ‰€ä»¥åœ¨æ‰§è¡Œå®Œ`func2`åï¼Œå…¨å±€å˜é‡`num`=6ã€‚

### Nested functions åµŒå¥—å‡½æ•°

æœ‰äº›æ—¶å€™æˆ‘ä»¬åœ¨åŒä¸€ä¸ªå‡½æ•°å†…éœ€è¦é‡å¤çš„ä½¿ç”¨ç›¸åŒçš„è¿ç®—ï¼Œä¾‹å¦‚ï¼š

```python
def mod2plus5(x1, x2, x3):
  """Returns the remainder plus 5 of three values."""
  new_x1 = x1 % 2 + 5
  new_x2 = x2 % 2 + 5
  new_x3 = x3 % 2 + 5
  return (new_x1, new_x2, new_x3)
```

è¿™æ ·åšä¸å¤Ÿä¼˜é›…ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨åµŒå¥—å‡½æ•°åˆ°è¾¾åŒæ ·çš„ç›®çš„ï¼š

```python
def mod2plus5(x1, x2, x3):
  """Returns the remainder plus 5 of three values."""
  def inner(x):
    """Returns the remainder plus 5 of a value."""
    return x % 2 + 5
  return (inner(x1), inner(x2), inner(x3))
```

```python
print(mod2plus5(1, 2, 3))
```

```
(6, 5, 6)
```

åµŒå¥—å‡½æ•°çš„å¥½å¤„ä¸ä»…å¯ä»¥å‡å°‘é‡å¤çš„ä»£ç ï¼Œè¿˜å¯ä»¥é—­åŒ…å‚¨å­˜å±€éƒ¨å˜é‡ï¼Œä¾‹å¦‚ï¼š

```python
def raise_val(n):
  """Return the inner function."""
  def inner(x):
    """Raise x to the power of n."""
    raised = x ** n
    return raised
  return inner
```

```python
square = raise_val(2)
cube = raise_val(3)
print(square(2), cube(4))
```

```
4 64
```

æ³¨æ„`raise_val`çš„è¿”å›å€¼æ˜¯`inner`ï¼Œç›¸å½“äºåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å‡½æ•°åå«`square`ã€‚å…¶å‚æ•°2è¢«ä¼ å…¥`inner`ä¿å­˜äº†ä¸‹æ¥ã€‚å†æ¬¡è°ƒç”¨`square`æ—¶ï¼Œ`n`å·²è¢«èµ‹å€¼2ï¼Œæ‰€ä»¥è¿”å›å€¼`raised`=2**2=4ã€‚

### nonlocal å…³é”®å­—

æˆ‘ä»¬å·²ç»çŸ¥é“globalå¯ä»¥ä¿®é¥°æœ¬åœ°å˜é‡å˜ä¸ºå…¨å±€å˜é‡ã€‚nonlocalç›¸å½“äºåµŒå¥—å‡½æ•°å†…çš„å…¨å±€ã€‚é‡Œå±‚å‡½æ•°é€šè¿‡nonlocalå¯ä»¥ä¿®æ”¹å¤–å±‚å‡½æ•°çš„å˜é‡ã€‚å¦‚ä¸‹ï¼š

```python
def outer():
    n = 3
    def inner():
        nonlocal n
        n = 2
        ininer()
        print(n)
    inner()
    print(n)
outer()
```

```
2
2
```

å‡½æ•°å¤–å±‚çš„å˜é‡è¢«`inner`å‡½æ•°ä¿®æ”¹ï¼Œæ‰€ä»¥ä¸¤æ¬¡è¾“å‡ºéƒ½ä¸º2ã€‚

### LEGB scope searched sequence ä½œç”¨åŸŸçš„é¡ºåº

ç°åœ¨æˆ‘ä»¬å¯ä»¥å®šä¹‰å®Œæ•´çš„ä½œç”¨åŸŸé¡ºåºäº†ï¼Œä¹Ÿè¢«ç§°ä¸ºLEGBæ³•åˆ™ã€‚pythonå…ˆæŸ¥è¯¢localæœ¬åœ°ä½œç”¨åŸŸï¼Œç„¶åæ˜¯ecclosingåµŒå¥—ä½œç”¨åŸŸï¼Œå†æŸ¥è¯¢globalå…¨å±€ä½œç”¨åŸŸï¼Œæœ€åå†…ç½®ä½œç”¨åŸŸã€‚å¦‚æœå››ä¸ªåœ°æ–¹éƒ½æ²¡æœ‰å®šä¹‰å˜é‡ï¼Œåˆ™ä¼šæŠ¥é”™ã€‚

- **L**ocal scope æœ¬åœ°ä½œç”¨åŸŸ
- **E**nclosing åµŒå¥—ä½œç”¨åŸŸ
- **G**lobal scope å…¨å±€ä½œç”¨åŸŸ
- **B**uilt-in scope å†…ç½®ä½œç”¨åŸŸ

